-- 1 CREO  LA TABLA CLIENTES

CREATE TABLE DS_CLIENTES (
    NRO_CLIENTE NUMBER,
    NOMBRE_CLIENTE VARCHAR2(50),
    APELLIDO1_CLIENTE VARCHAR2(30),
    APELLIDO2_CLIENTE VARCHAR2(30),
    DIRECCION_CLIENTE VARCHAR2(80),
    SALDO NUMBER,
    CREDITO NUMBER,
    DESCUENTO NUMBER,
    CONSTRAINT PK_DS_CLIENTES PRIMARY KEY(NRO_CLIENTE)
);


-- 2 ALTER TABLE - AGREGO CAMPO CIUDAD

ALTER TABLE DS_CLIENTES 
    ADD CIUDAD_CLIENTE VARCHAR2(80);

-- 3 DESHABILITAR Y LUEGO HABILITAR LA PK

ALTER TABLE DS_CLIENTES
    MODIFY CONSTRAINT PK_DS_CLIENTES DISABLE;

ALTER TABLE DS_CLIENTES
    MODIFY CONSTRAINT PK_DS_CLIENTES ENABLE;

-- 4 INSERTAR REGISTROS EN CLIENTES
INSERT INTO DS_CLIENTES(NRO_CLIENTE, NOMBRE_CLIENTE, APELLIDO1_CLIENTE, APELLIDO2_CLIENTE, DIRECCION_CLIENTE, SALDO, CREDITO, DESCUENTO)
VALUES (1, 'CARLOS', 'CASTRO', 'BUSTAMANTE', 'TALCA', 500, 5000, 20);

INSERT INTO DS_CLIENTES(NRO_CLIENTE, NOMBRE_CLIENTE, APELLIDO1_CLIENTE, APELLIDO2_CLIENTE, DIRECCION_CLIENTE, SALDO, CREDITO, DESCUENTO)
VALUES (2, 'ALICIA', 'SANHUEZA', 'BRAVO', 'VILLA ALEGRE', 600, 2000, 40);

INSERT INTO DS_CLIENTES(NRO_CLIENTE, NOMBRE_CLIENTE, APELLIDO1_CLIENTE, APELLIDO2_CLIENTE, DIRECCION_CLIENTE, SALDO, CREDITO, DESCUENTO)
VALUES (3, 'PEDRO', 'BRAVO', 'NUÑEZ', 'LINARES', 10000, 1000, 60);

--5 UPDATE: CAMBIAR APELLIDO2 DE PEDRITO
UPDATE DS_CLIENTES
SET APELLIDO2_CLIENTE = 'SOTO'
WHERE NRO_CLIENTE = 3;

-- 6 DELETE: ELIMINAR CLIENTE CON APELLIDO2 SOTO
DELETE FROM DS_CLIENTES
WHERE APELLIDO2_CLIENTE = 'SOTO';

-- 7 SELECT: CONSULTAS BÁSICAS
SELECT * FROM DS_CLIENTES;

SELECT NRO_CLIENTE, NOMBRE_CLIENTE, APELLIDO1_CLIENTE, DESCUENTO
FROM DS_CLIENTES
WHERE DESCUENTO > 20;

-- 8 INSERCIONES EN AUTORES
INSERT INTO DS_AUTORES(COD_AUTOR,NOMBRE_AUTOR,APELLIDO1_AUTOR,APELLIDO2_AUTOR)
VALUES(1,'CARLOS','CASTRO','BUSTAMANTE');

INSERT INTO DS_AUTORES(COD_AUTOR,NOMBRE_AUTOR,APELLIDO1_AUTOR,APELLIDO2_AUTOR)
VALUES(2,'HUGO','ARAYA','CARRASCO');

INSERT INTO DS_AUTORES(COD_AUTOR,NOMBRE_AUTOR,APELLIDO1_AUTOR,APELLIDO2_AUTOR)
VALUES(3,'FRANCISCO','VASQUEZ','IGLESIAS');

INSERT INTO DS_AUTORES(COD_AUTOR,NOMBRE_AUTOR,APELLIDO1_AUTOR,APELLIDO2_AUTOR)
VALUES(4,'MARCO','TORANZO','CESPEDES');

INSERT INTO DS_AUTORES(COD_AUTOR,NOMBRE_AUTOR,APELLIDO1_AUTOR,APELLIDO2_AUTOR)
VALUES(5,'LUIS','PONCE','ROSALES');

-- 9 INSERCIONES EN EDITORIALES
INSERT INTO DS_EDITORIALES(COD_EDITORIAL,NOMBRE_EDITORIAL)
VALUES(1,'ALFAOMEGA');

INSERT INTO DS_EDITORIALES(COD_EDITORIAL,NOMBRE_EDITORIAL)
VALUES(2,'ALMARA');

INSERT INTO DS_EDITORIALES(COD_EDITORIAL,NOMBRE_EDITORIAL)
VALUES(3,'MCGRAWHILL');

INSERT INTO DS_EDITORIALES(COD_EDITORIAL,NOMBRE_EDITORIAL)
VALUES(4,'UCM');

INSERT INTO DS_EDITORIALES(COD_EDITORIAL,NOMBRE_EDITORIAL)
VALUES(5,'UTALCA');

-- 10 INSERCIONES EN LIBROS
INSERT INTO DS_LIBROS(COD_LIBRO, ISBN_LIBRO,TITULO_LIBRO,NRO_PAGINAS_LIBRO,COD_EDITORIAL)
VALUES(1,12345678,'PYHTON FOR DUMMIES',300,2);

INSERT INTO DS_LIBROS(COD_LIBRO, ISBN_LIBRO,TITULO_LIBRO,NRO_PAGINAS_LIBRO,COD_EDITORIAL)
VALUES(2,23456789,'MATEMATICA PARA INGENIERIA',500,1);

INSERT INTO DS_LIBROS(COD_LIBRO, ISBN_LIBRO,TITULO_LIBRO,NRO_PAGINAS_LIBRO,COD_EDITORIAL)
VALUES(3,34567890,'MAGALLANES EL MEJOR EQUIPO',80,4);

INSERT INTO DS_LIBROS(COD_LIBRO, ISBN_LIBRO,TITULO_LIBRO,NRO_PAGINAS_LIBRO,COD_EDITORIAL)
VALUES(4,45678901,'BASE DE DATOS',800,3);

INSERT INTO DS_LIBROS(COD_LIBRO, ISBN_LIBRO,TITULO_LIBRO,NRO_PAGINAS_LIBRO,COD_EDITORIAL)
VALUES(5,56789012,'PROGRAMACION BASICA',180,5);

-- 11 INSERCIONES EN DETALLE_LIBRO_AUTOR
INSERT INTO DS_DETALLE_LIBRO_AUTOR(COD_AUTOR,COD_LIBRO) VALUES(3,1);
INSERT INTO DS_DETALLE_LIBRO_AUTOR(COD_AUTOR,COD_LIBRO) VALUES(3,4);
INSERT INTO DS_DETALLE_LIBRO_AUTOR(COD_AUTOR,COD_LIBRO) VALUES(2,3);
INSERT INTO DS_DETALLE_LIBRO_AUTOR(COD_AUTOR,COD_LIBRO) VALUES(1,3);

-- 12 CONSULTAS ESPECIALES 

-- Libros con editorial > 3
SELECT *
FROM DS_LIBROS 
WHERE (COD_EDITORIAL > 3);

-- Prestamos antes del 17/06/2025
SELECT *
FROM DS_PRESTAMOS
WHERE FECHA_PRESTAMO < TO_DATE('06/17/2025', 'MM/DD/YYYY');

-- Prestamos con ejemplar 3
SELECT *
FROM DS_PRESTAMOS
WHERE COD_EJEMPLAR = 3;

